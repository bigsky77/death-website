{"version":3,"sources":["../../server/font-utils.ts"],"names":["Log","GOOGLE_FONT_PROVIDER","DEFAULT_SERIF_FONT","DEFAULT_SANS_SERIF_FONT","googleFontsMetrics","require","https","CHROME_UA","IE_UA","isGoogleFont","url","startsWith","getFontForUA","UA","Promise","resolve","reject","rawData","get","headers","res","on","chunk","toString","e","getFontDefinitionFromNetwork","result","warn","getFontDefinitionFromManifest","manifest","find","font","content","parseGoogleFontName","css","regex","matches","matchAll","fontNames","Set","fontFamily","replace","add","formatOverrideValue","val","Math","abs","toFixed","calculateOverrideValues","fontMetrics","fontKey","trim","category","ascent","descent","lineGap","unitsPerEm","fallbackFont","name","calculateSizeAdjustValues","xAvgCharWidth","sizeAdjust","calculateOverrideCSS","fontName","calculateSizeAdjustCSS","getFontOverrideCss","useSizeAdjust","calcFn","fontCss","reduce","cssStr","console","log"],"mappings":"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"}